# å·¥å…·ç±»ä½¿ç”¨æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç»toolkitæ¨¡å—ä¸­å„ç§å·¥å…·ç±»çš„ä½¿ç”¨æ–¹æ³•ã€è®¾è®¡åŸç†å’Œæœ€ä½³å®è·µã€‚è¿™äº›å·¥å…·ç±»æ˜¯ä¼ä¸šåº”ç”¨å¼€å‘ä¸­ç»è¿‡ç”Ÿäº§éªŒè¯çš„å¸¸ç”¨ç»„ä»¶ã€‚

## ğŸ› ï¸ å·²å®ç°å·¥å…·ç±»

### 1. å¼‚å¸¸å¤„ç†å·¥å…·

#### Assert æ–­è¨€å·¥å…·ç±»
æä¾›æ–­è¨€é£æ ¼çš„éªŒè¯æ–¹æ³•ï¼Œç®€åŒ–å‚æ•°å’Œä¸šåŠ¡è§„åˆ™éªŒè¯ã€‚

```java
// åŸºç¡€æ–­è¨€
Assert.notNull(user, "ç”¨æˆ·å¯¹è±¡ä¸èƒ½ä¸ºç©º");
Assert.notBlank(username, "ç”¨æˆ·åä¸èƒ½ä¸ºç©º");
Assert.notEmpty(list, "åˆ—è¡¨ä¸èƒ½ä¸ºç©º");

// æ•°å€¼æ–­è¨€
Assert.isTrue(age > 0, "å¹´é¾„å¿…é¡»å¤§äº0");
Assert.isFalse(username.contains("admin"), "ç”¨æˆ·åä¸èƒ½åŒ…å«admin");

// ä¸šåŠ¡è§„åˆ™æ–­è¨€
Assert.state(user.isActive(), "ç”¨æˆ·çŠ¶æ€å¿…é¡»ä¸ºæ¿€æ´»");
Assert.expression(user.getAge() >= 18, "ç”¨æˆ·å¹´é¾„å¿…é¡»å¤§äºç­‰äº18å²");
```

#### ExceptionUtils å¼‚å¸¸å·¥å…·ç±»
æä¾›ä¾¿æ·çš„å¼‚å¸¸åˆ›å»ºå’ŒæŠ›å‡ºæ–¹æ³•ã€‚

```java
// å¿«é€ŸæŠ›å‡ºå¼‚å¸¸
ExceptionUtils.throwBusiness(I18nCommonExceptionCode.DATA_NOT_FOUND);
ExceptionUtils.throwSystem(I18nCommonExceptionCode.DATABASE_ERROR);

// æ¡ä»¶å¼‚å¸¸
ExceptionUtils.throwBusinessIf(user == null, I18nCommonExceptionCode.USER_NOT_FOUND);
ExceptionUtils.throwSystemIf(connection == null, I18nCommonExceptionCode.CONNECTION_FAILED);

// å‚æ•°éªŒè¯
ExceptionUtils.requireNonNull(request, "request");
ExceptionUtils.requireNonBlank(username, "username");
ExceptionUtils.requireTrue(isValid, I18nCommonExceptionCode.PARAM_INVALID);

// åˆ›å»ºå¼‚å¸¸ï¼ˆä¸æŠ›å‡ºï¼‰
BusinessException exception = ExceptionUtils.business(errorCode);
SystemException sysException = ExceptionUtils.system(errorCode, cause);
```

### 2. å“åº”å¤„ç†å·¥å…·

#### Response ç»Ÿä¸€å“åº”ç±»
æä¾›æ ‡å‡†åŒ–çš„APIå“åº”æ ¼å¼ã€‚

```java
// æˆåŠŸå“åº”
Response<User> response = Response.success(user);
Response<List<User>> listResponse = Response.success(userList);
Response<Void> voidResponse = Response.success();

// å¤±è´¥å“åº”
Response<Void> errorResponse = Response.error(errorCode, message);
Response<Void> businessError = Response.businessError(I18nCommonExceptionCode.USER_NOT_FOUND);
Response<Void> systemError = Response.systemError(I18nCommonExceptionCode.DATABASE_ERROR);

// å“åº”æ ¼å¼
{
  "code": 0,          // 0è¡¨ç¤ºæˆåŠŸï¼Œå…¶ä»–è¡¨ç¤ºé”™è¯¯ç 
  "message": "æ“ä½œæˆåŠŸ", // å“åº”æ¶ˆæ¯
  "data": {...}       // å“åº”æ•°æ®
}
```

### 3. åˆ†é¡µæŸ¥è¯¢å·¥å…·

#### Pagination åˆ†é¡µç»“æœç±»
æ ‡å‡†åŒ–çš„åˆ†é¡µå“åº”æ ¼å¼ã€‚

```java
// åˆ›å»ºåˆ†é¡µç»“æœ
List<User> users = userService.queryUsers(query);
long total = userService.countUsers(query);
Pagination<User> pagination = Pagination.of(users, total, query.getPageNum(), query.getPageSize());

// åˆ†é¡µå“åº”æ ¼å¼
{
  "records": [...],     // æ•°æ®åˆ—è¡¨
  "total": 100,         // æ€»è®°å½•æ•°
  "pageNum": 1,         // å½“å‰é¡µç 
  "pageSize": 10,       // æ¯é¡µå¤§å°
  "pages": 10,          // æ€»é¡µæ•°
  "hasNext": true,      // æ˜¯å¦æœ‰ä¸‹ä¸€é¡µ
  "hasPrevious": false  // æ˜¯å¦æœ‰ä¸Šä¸€é¡µ
}
```

#### AbstractPageQuery æŠ½è±¡åˆ†é¡µæŸ¥è¯¢ç±»
æä¾›æ ‡å‡†çš„åˆ†é¡µæŸ¥è¯¢åŸºç±»ã€‚

```java
public class UserQuery extends AbstractPageQuery {
    private String username;
    private String email;
    private QueryType status;
    
    // getter/setter...
}

// ä½¿ç”¨ç¤ºä¾‹
UserQuery query = new UserQuery();
query.setPageNum(1);
query.setPageSize(10);
query.setUsername("admin");

// è‡ªåŠ¨å¤„ç†åˆ†é¡µå‚æ•°
if (query.getPageNum() == null) {
    query.setPageNum(1);
}
if (query.getPageSize() == null) {
    query.setPageSize(10);
}
```

### 4. æŸ¥è¯¢æ¡ä»¶å·¥å…·

#### QueryWrapperHelper æŸ¥è¯¢åŒ…è£…å™¨åŠ©æ‰‹
ç®€åŒ–MyBatisæŸ¥è¯¢æ¡ä»¶æ„å»ºã€‚

```java
QueryWrapper<User> wrapper = QueryWrapperHelper.buildWrapper(query);
// è‡ªåŠ¨æ ¹æ®queryå¯¹è±¡æ„å»ºæŸ¥è¯¢æ¡ä»¶

// è‡ªå®šä¹‰æŸ¥è¯¢æ¡ä»¶
QueryWrapper<User> customWrapper = new QueryWrapper<>();
QueryWrapperHelper.addCondition(customWrapper, "username", query.getUsername());
QueryWrapperHelper.addLikeCondition(customWrapper, "email", query.getEmail());
QueryWrapperHelper.addInCondition(customWrapper, "status", query.getStatusList());
```

## ğŸš€ è®¡åˆ’å®ç°çš„å·¥å…·ç±»

### 1. æ—¥æœŸæ—¶é—´å·¥å…· (DateTimeUtils)

```java
// æ—¥æœŸæ ¼å¼åŒ–
String formatted = DateTimeUtils.format(LocalDateTime.now(), "yyyy-MM-dd HH:mm:ss");
String isoString = DateTimeUtils.toIsoString(LocalDateTime.now());

// æ—¥æœŸè§£æ
LocalDateTime dateTime = DateTimeUtils.parse("2023-12-01 10:30:00", "yyyy-MM-dd HH:mm:ss");
LocalDate date = DateTimeUtils.parseDate("2023-12-01");

// æ—¥æœŸè®¡ç®—
LocalDateTime tomorrow = DateTimeUtils.addDays(LocalDateTime.now(), 1);
LocalDateTime nextWeek = DateTimeUtils.addWeeks(LocalDateTime.now(), 1);
long daysBetween = DateTimeUtils.daysBetween(startDate, endDate);

// æ—¶åŒºè½¬æ¢
ZonedDateTime utc = DateTimeUtils.toUTC(LocalDateTime.now());
LocalDateTime local = DateTimeUtils.toLocal(utcDateTime, ZoneId.of("Asia/Shanghai"));

// ä¸šåŠ¡æ—¥æœŸåˆ¤æ–­
boolean isWorkday = DateTimeUtils.isWorkday(LocalDate.now());
boolean isWeekend = DateTimeUtils.isWeekend(LocalDate.now());
LocalDate nextWorkday = DateTimeUtils.nextWorkday(LocalDate.now());
```

### 2. å­—ç¬¦ä¸²å¤„ç†å·¥å…· (StringUtils)

```java
// å­—ç¬¦ä¸²éªŒè¯
boolean isEmpty = StringUtils.isEmpty(str);
boolean isBlank = StringUtils.isBlank(str);
boolean hasText = StringUtils.hasText(str);

// å­—ç¬¦ä¸²è½¬æ¢
String camelCase = StringUtils.toCamelCase("user_name");        // userName
String snakeCase = StringUtils.toSnakeCase("userName");         // user_name
String kebabCase = StringUtils.toKebabCase("userName");         // user-name
String pascalCase = StringUtils.toPascalCase("user_name");      // UserName

// å­—ç¬¦ä¸²å¤„ç†
String truncated = StringUtils.truncate(longText, 100);
String masked = StringUtils.mask("18888888888", 3, 4, '*');     // 188****8888
String padded = StringUtils.padLeft("123", 6, '0');            // 000123

// å­—ç¬¦ä¸²å®‰å…¨
String escaped = StringUtils.escapeHtml(htmlContent);
String unescaped = StringUtils.unescapeHtml(escapedContent);
boolean isSafe = StringUtils.isSqlSafe(input);

// ä¸­æ–‡å¤„ç†
boolean isChinese = StringUtils.isChinese(text);
int chineseLength = StringUtils.getChineseLength(text);
String pinyin = StringUtils.toPinyin("ä¸­å›½");                   // zhongguo
```

### 3. é›†åˆæ“ä½œå·¥å…· (CollectionUtils)

```java
// é›†åˆéªŒè¯
boolean isEmpty = CollectionUtils.isEmpty(list);
boolean isNotEmpty = CollectionUtils.isNotEmpty(list);

// é›†åˆè½¬æ¢
List<String> names = CollectionUtils.map(users, User::getName);
Map<Long, User> userMap = CollectionUtils.toMap(users, User::getId);
List<Long> ids = CollectionUtils.extractProperty(users, "id", Long.class);

// é›†åˆè¿‡æ»¤
List<User> activeUsers = CollectionUtils.filter(users, User::isActive);
List<User> adults = CollectionUtils.filter(users, user -> user.getAge() >= 18);

// é›†åˆåˆ†ç»„
Map<String, List<User>> groupByCity = CollectionUtils.groupBy(users, User::getCity);
Map<Boolean, List<User>> partitioned = CollectionUtils.partition(users, User::isActive);

// é›†åˆè¿ç®—
List<User> intersection = CollectionUtils.intersection(list1, list2);
List<User> union = CollectionUtils.union(list1, list2);
List<User> difference = CollectionUtils.difference(list1, list2);

// åˆ†é¡µå¤„ç†
List<User> page = CollectionUtils.page(users, 1, 10);
List<List<User>> batches = CollectionUtils.batch(users, 100);
```

### 4. JSONå¤„ç†å·¥å…· (JsonUtils)

```java
// å¯¹è±¡è½¬JSON
String json = JsonUtils.toJson(user);
String prettyJson = JsonUtils.toPrettyJson(user);

// JSONè½¬å¯¹è±¡
User user = JsonUtils.fromJson(json, User.class);
List<User> users = JsonUtils.fromJsonList(json, User.class);
Map<String, Object> map = JsonUtils.fromJsonMap(json);

// ç±»å‹å®‰å…¨è½¬æ¢
Optional<User> userOpt = JsonUtils.tryFromJson(json, User.class);
List<User> safeUsers = JsonUtils.fromJsonListSafe(json, User.class);

// JSONæ“ä½œ
boolean isValidJson = JsonUtils.isValidJson(json);
Object value = JsonUtils.getValue(json, "user.name");
String updatedJson = JsonUtils.setValue(json, "user.age", 25);

// é…ç½®é€‰é¡¹
JsonUtils.configure(config -> {
    config.setDateFormat("yyyy-MM-dd HH:mm:ss");
    config.setIgnoreNullValues(true);
    config.setIgnoreUnknownProperties(true);
});
```

### 5. æ–‡ä»¶æ“ä½œå·¥å…· (FileUtils)

```java
// æ–‡ä»¶è¯»å†™
String content = FileUtils.readString(path);
byte[] bytes = FileUtils.readBytes(path);
List<String> lines = FileUtils.readLines(path);

FileUtils.writeString(path, content);
FileUtils.writeBytes(path, bytes);
FileUtils.writeLines(path, lines);

// æ–‡ä»¶ä¿¡æ¯
boolean exists = FileUtils.exists(path);
long size = FileUtils.size(path);
String extension = FileUtils.getExtension(path);
String mimeType = FileUtils.getMimeType(path);

// æ–‡ä»¶æ“ä½œ
boolean copied = FileUtils.copy(sourcePath, targetPath);
boolean moved = FileUtils.move(sourcePath, targetPath);
boolean deleted = FileUtils.delete(path);

// ç›®å½•æ“ä½œ
boolean created = FileUtils.createDirectories(dirPath);
List<Path> files = FileUtils.listFiles(dirPath);
List<Path> filtered = FileUtils.listFiles(dirPath, "*.java");

// æ–‡ä»¶ä¸Šä¼ å¤„ç†
boolean isValidImage = FileUtils.isValidImageFile(multipartFile);
String savedPath = FileUtils.saveUploadFile(multipartFile, uploadDir);
BufferedImage resized = FileUtils.resizeImage(imagePath, 800, 600);
```

### 6. ç½‘ç»œè¯·æ±‚å·¥å…· (HttpUtils)

```java
// GET è¯·æ±‚
String response = HttpUtils.get("https://api.example.com/users");
User user = HttpUtils.get("https://api.example.com/users/1", User.class);

// POST è¯·æ±‚
String result = HttpUtils.post("https://api.example.com/users", userJson);
User created = HttpUtils.post("https://api.example.com/users", createRequest, User.class);

// å¸¦å‚æ•°è¯·æ±‚
Map<String, String> params = Map.of("page", "1", "size", "10");
String response = HttpUtils.get("https://api.example.com/users", params);

// å¸¦å¤´éƒ¨è¯·æ±‚
Map<String, String> headers = Map.of("Authorization", "Bearer " + token);
String response = HttpUtils.get("https://api.example.com/users", params, headers);

// æ–‡ä»¶ä¸Šä¼ 
String result = HttpUtils.uploadFile("https://api.example.com/upload", file);

// å¼‚æ­¥è¯·æ±‚
CompletableFuture<String> future = HttpUtils.getAsync("https://api.example.com/users");
```

### 7. åŠ å¯†å·¥å…· (CryptoUtils)

```java
// MD5 å’Œ SHA
String md5 = CryptoUtils.md5(text);
String sha256 = CryptoUtils.sha256(text);
String sha512 = CryptoUtils.sha512(text);

// Base64 ç¼–ç 
String encoded = CryptoUtils.base64Encode(data);
byte[] decoded = CryptoUtils.base64Decode(encoded);

// AES åŠ å¯†
String encrypted = CryptoUtils.aesEncrypt(plaintext, key);
String decrypted = CryptoUtils.aesDecrypt(encrypted, key);

// RSA åŠ å¯†
KeyPair keyPair = CryptoUtils.generateRSAKeyPair();
String encrypted = CryptoUtils.rsaEncrypt(plaintext, keyPair.getPublic());
String decrypted = CryptoUtils.rsaDecrypt(encrypted, keyPair.getPrivate());

// å¯†ç å¤„ç†
String hashed = CryptoUtils.hashPassword(password);
boolean matches = CryptoUtils.checkPassword(password, hashed);

// éšæœºç”Ÿæˆ
String randomString = CryptoUtils.randomString(16);
String uuid = CryptoUtils.randomUUID();
byte[] salt = CryptoUtils.generateSalt();
```

### 8. æ•°æ®éªŒè¯å·¥å…· (ValidationUtils)

```java
// åŸºç¡€éªŒè¯
boolean isEmail = ValidationUtils.isEmail("user@example.com");
boolean isMobile = ValidationUtils.isMobile("18888888888");
boolean isIdCard = ValidationUtils.isIdCard("110101199001011234");

// æ­£åˆ™éªŒè¯
boolean matches = ValidationUtils.matches(text, pattern);
boolean isAlphanumeric = ValidationUtils.isAlphanumeric(text);
boolean isNumeric = ValidationUtils.isNumeric(text);

// ä¸šåŠ¡éªŒè¯
boolean isValidPassword = ValidationUtils.isStrongPassword(password);
boolean isValidUsername = ValidationUtils.isValidUsername(username);
boolean isValidUrl = ValidationUtils.isUrl(url);

// é“¶è¡Œå¡éªŒè¯
boolean isValidBankCard = ValidationUtils.isBankCard("6222000000000000");
boolean isValidCreditCard = ValidationUtils.isCreditCard("4111111111111111");

// è‡ªå®šä¹‰éªŒè¯å™¨
ValidationUtils.addValidator("custom", text -> text.startsWith("CUSTOM_"));
boolean isValid = ValidationUtils.validate("CUSTOM_123", "custom");
```

## ğŸ“– ä½¿ç”¨æœ€ä½³å®è·µ

### 1. å¼‚å¸¸å¤„ç†æœ€ä½³å®è·µ

```java
@Service
public class UserService {
    
    public User createUser(CreateUserRequest request) {
        // 1. å‚æ•°éªŒè¯
        ExceptionUtils.requireNonNull(request, "åˆ›å»ºç”¨æˆ·è¯·æ±‚ä¸èƒ½ä¸ºç©º");
        ExceptionUtils.requireNonBlank(request.getUsername(), "ç”¨æˆ·åä¸èƒ½ä¸ºç©º");
        ExceptionUtils.requireNonBlank(request.getEmail(), "é‚®ç®±ä¸èƒ½ä¸ºç©º");
        
        // 2. ä¸šåŠ¡è§„åˆ™éªŒè¯
        ExceptionUtils.requireTrue(ValidationUtils.isEmail(request.getEmail()), 
                                  I18nCommonExceptionCode.EMAIL_INVALID);
        ExceptionUtils.throwBusinessIf(userRepository.existsByUsername(request.getUsername()),
                                      I18nCommonExceptionCode.USER_ALREADY_EXISTS);
        
        // 3. ä¸šåŠ¡é€»è¾‘å¤„ç†
        try {
            User user = new User();
            // ... è®¾ç½®ç”¨æˆ·å±æ€§
            return userRepository.save(user);
        } catch (DataAccessException e) {
            // 4. ç³»ç»Ÿå¼‚å¸¸è½¬æ¢
            throw ExceptionUtils.system(I18nCommonExceptionCode.DATABASE_ERROR, e);
        }
    }
}
```

### 2. åˆ†é¡µæŸ¥è¯¢æœ€ä½³å®è·µ

```java
@RestController
public class UserController {
    
    @PostMapping("/users/query")
    public Response<Pagination<UserDTO>> queryUsers(@RequestBody UserQuery query) {
        // 1. å‚æ•°éªŒè¯å’Œé»˜è®¤å€¼è®¾ç½®
        if (query == null) {
            query = new UserQuery();
        }
        query.validateAndSetDefaults();
        
        // 2. æ‰§è¡ŒæŸ¥è¯¢
        List<User> users = userService.queryUsers(query);
        long total = userService.countUsers(query);
        
        // 3. è½¬æ¢ä¸ºDTO
        List<UserDTO> userDTOs = users.stream()
                .map(userConverter::toDTO)
                .collect(Collectors.toList());
        
        // 4. æ„å»ºåˆ†é¡µç»“æœ
        Pagination<UserDTO> result = Pagination.of(userDTOs, total, 
                                                  query.getPageNum(), query.getPageSize());
        
        return Response.success(result);
    }
}
```

### 3. å·¥å…·ç±»ç»„åˆä½¿ç”¨

```java
@Service
public class FileUploadService {
    
    public String uploadAvatar(MultipartFile file, Long userId) {
        // 1. å‚æ•°éªŒè¯
        ExceptionUtils.requireNonNull(file, "ä¸Šä¼ æ–‡ä»¶ä¸èƒ½ä¸ºç©º");
        ExceptionUtils.requireNonNull(userId, "ç”¨æˆ·IDä¸èƒ½ä¸ºç©º");
        
        // 2. æ–‡ä»¶éªŒè¯
        ExceptionUtils.requireTrue(FileUtils.isValidImageFile(file), 
                                  "åªæ”¯æŒå›¾ç‰‡æ ¼å¼æ–‡ä»¶");
        ExceptionUtils.requireTrue(file.getSize() <= 5 * 1024 * 1024, 
                                  "æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡5MB");
        
        // 3. ç”Ÿæˆæ–‡ä»¶å
        String extension = FileUtils.getExtension(file.getOriginalFilename());
        String fileName = StringUtils.format("avatar_{}_{}.{}", 
                                           userId, System.currentTimeMillis(), extension);
        
        // 4. ä¿å­˜æ–‡ä»¶
        String uploadPath = "/uploads/avatars/" + DateTimeUtils.format(LocalDate.now(), "yyyy/MM/dd");
        String savedPath = FileUtils.saveUploadFile(file, uploadPath, fileName);
        
        // 5. è®°å½•æ“ä½œæ—¥å¿—
        log.info("ç”¨æˆ· {} ä¸Šä¼ å¤´åƒæˆåŠŸï¼Œæ–‡ä»¶è·¯å¾„: {}", userId, savedPath);
        
        return savedPath;
    }
}
```

## ğŸ”§ æ‰©å±•æŒ‡å—

### 1. è‡ªå®šä¹‰å·¥å…·ç±»

åˆ›å»ºè‡ªå®šä¹‰å·¥å…·ç±»æ—¶ï¼Œè¯·éµå¾ªä»¥ä¸‹è§„èŒƒï¼š

```java
/**
 * è‡ªå®šä¹‰å·¥å…·ç±»ç¤ºä¾‹
 * 
 * @author yourname
 * @since 1.0.0
 */
public final class CustomUtils {
    
    private CustomUtils() {
        // ç§æœ‰æ„é€ å‡½æ•°ï¼Œé˜²æ­¢å®ä¾‹åŒ–
    }
    
    /**
     * å·¥å…·æ–¹æ³•è¯´æ˜
     * 
     * @param param å‚æ•°è¯´æ˜
     * @return è¿”å›å€¼è¯´æ˜
     * @throws IllegalArgumentException å‚æ•°å¼‚å¸¸è¯´æ˜
     */
    public static String customMethod(String param) {
        // 1. å‚æ•°éªŒè¯
        ExceptionUtils.requireNonBlank(param, "å‚æ•°ä¸èƒ½ä¸ºç©º");
        
        // 2. ä¸šåŠ¡é€»è¾‘
        // ...
        
        return result;
    }
}
```

### 2. å·¥å…·ç±»æµ‹è¯•

```java
@ExtendWith(MockitoExtension.class)
class CustomUtilsTest {
    
    @Test
    void testCustomMethod_Success() {
        // given
        String input = "test";
        
        // when
        String result = CustomUtils.customMethod(input);
        
        // then
        assertThat(result).isNotNull();
        assertThat(result).isEqualTo("expected");
    }
    
    @Test
    void testCustomMethod_ThrowsException_WhenParamIsNull() {
        // when & then
        assertThatThrownBy(() -> CustomUtils.customMethod(null))
                .isInstanceOf(IllegalArgumentException.class)
                .hasMessage("å‚æ•°ä¸èƒ½ä¸ºç©º");
    }
}
```

## ğŸ“š å‚è€ƒèµ„æ–™

- [Apache Commons Lang](https://commons.apache.org/proper/commons-lang/) - å­—ç¬¦ä¸²å’Œå¯¹è±¡å·¥å…·
- [Google Guava](https://github.com/google/guava) - é›†åˆå’Œå·¥å…·ç±»
- [Hutool](https://hutool.cn/) - Javaå·¥å…·åŒ…
- [Spring Framework Utilities](https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/util/package-summary.html) - Springå·¥å…·ç±»